<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title></title>
    <meta charset="utf-8" />
</head>
<link rel="stylesheet" href="../../css/bootstrap.min.css" />
<link href="../../css/plugins/bootstrapTable/bootstrap-table.min.css" rel="stylesheet" />
<link href="../../css/plugins/sweetalert/sweetalert.css" rel="stylesheet" />
<link href="../../css/ReportConfig.css" rel="stylesheet" />

<script src="../../Scripts/jquery-1.9.1.min.js"></script>
<script src="../../Scripts/jquery.cookie.js"></script>
<script src="../../Scripts/bootstrap.min.js"></script>
<script src="../../Scripts/plugins/bootstrapTable/bootstrap-table.min.js"></script>
<script src="../../Scripts/plugins/layer/layer.min.js"></script>
<script src="../../Scripts/plugins/sweetalert/sweetalert.min.js"></script>

<script src="../../Scripts/global.js"></script>
<script src="../../Scripts/MesClient.js"></script>
<script src="../../Scripts/MesClient.UI.js"></script>
<script src="../../Scripts/Report/MesClient.ReportConfig.js"></script>
<body>
    <div class="title">
        <i class="glyphicon glyphicon-tags">&nbsp;</i><span set-lan="html:"></span>
    </div>
    <div class="list">
        <div class="btnList"></div>
        <div class="query">
            <div class="input">
                <input type="text" value="" placeholder="" />
            </div>
        </div>
    </div>
    <div class="tab">
        <table></table>
    </div>
</body>
<script type="text/javascript">

    var c = {
        "pageMsg": {
            "pageName": "DeviationConfig",                    //title名
            "setLan": "DeviationConfig",                          //该网页的多语言标签名
            "queryTip": "Sku or Deviation",             //查询框的提示信息
            "btnMsg": [
                  //{
                  //    "id": "btn1",
                  //    "btnName": "Edit",
                  //    "layerBtnName": "edit",
                  //    "icon": "glyphicon glyphicon-pencil",
                  //    "style": "1",
                  //    "layerFlag": true
                  //}
            ],
        },
        "apiList": {                                                                 //该网页的重要操作对应的前端与后台交互的api（homePage select 都是固定的写法，除此之外名称全部与按钮名称一致）
            "homePage": {                                                       //首页的api（homePage：固定写法，用于加载首页表数据）
                "className": "MESStation.Config.AgileDeviationConfig",   //该api对应的后台的类路径
                "functionName": "GetAllAgileDeviationList",                                  //该api名称（方法名称）
                "colList": ["TRUCK_SEQ"],                                 //后台接收数据的键的集合（大框操作不需要配置，下同；其它情况此项必填，下同）
                "sendList": [""]                                                 //后台接收数据的值的集合（与键一一对应）
            },
            "select": {                                                            //查询框(select:固定写法，用于快速查询表数据)
                "className": "MESStation.Config.AgileDeviationConfig",
                "functionName": "SearchAgileDeviationList",
                "colList": ["DEV_NUMBER"]
            },
            "Edit": {
                "className": "MESStation.Config.AgileDeviationConfig",
                "functionName": "EditAgileDeviationConfig"
            }
        },
        "tableMsg": {                                                           //该表的各字段集合
            "column": ['DEV_NUMBER', 'DEV_TYPE', 'CUSTOMER_DEV', 'BU', 'MFG', 'DATE_ORIGINATED', 'EFFECTIVE_FROM', 'EFFECTIVE_TO', 'ITEM_NUMBER', 'OWNER', 'UPDATE_DATE', 'EXECUTIVE', 'CREATE_TIME', 'EDIT_TIME', 'EDIT_EMP', 'STATUS', 'ITEM_SOURCE', 'JUSTIFICATION']
        },
        "layerMsg": {                                                           //弹出框（针对大框）各个控件的配置
            "Edit": {
                "showList": [
                    {
                        "field": "DEV_NUMBER",                                   //字段名,控件name,控件id(注意：必须使用变量的命名规则),语言配置名（重要）
                        "type": "text",                                         //控件类型（text：普通输入框 select：下拉框 checkbox：复选框 radio：单选框 textarea：大段文本框）
                        "disabled": true,                                     //是否不可编辑
                        "fillFlag": true                                       //弹出框后是否填充数据
                    },
                    {
                        'field': 'DEV_TYPE',
                        'type': 'text',
                        'disabled': true,
                        'fillFlag': true
                    },
                    {
                        "field": "CUSTOMER_DEV",
                        "type": "text",
                        "disabled": true,
                        "fillFlag": true
                        //  "labelList": ["是", "否"],                          //labelList：单选,复选所特有的配置项（表面显示的名字，对选中该控件解释说明，需要与valList配置项一一对应）
                        //"valList": [true, false]                               //valList：单选,复选所特有的配置项，（用于配置该控件的 value，需要和labelList配置项一一对应）
                    },
                    {
                        'field': 'BU',
                        'type': 'text',
                        'disabled': true,
                        'fillFlag': true
                    },
                    {
                        'field': 'MFG',
                        'type': 'text',
                        'disabled': true,
                        'fillFlag': true
                    },
                    {
                        'field': 'DATE_ORIGINATED',
                        'type': 'text',
                        'disabled': true,
                        'fillFlag': true
                    },
                    {
                        'field': 'EFFECTIVE_FROM',
                        'type': 'text',
                        'disabled': true,
                        'fillFlag': true
                    },
                    {
                        'field': 'EFFECTIVE_TO',
                        'type': 'text',
                        'disabled': true,
                        'fillFlag': true
                    },
                    {
                        'field': 'ITEM_NUMBER',
                        'type': 'text',
                        'disabled': true,
                        'fillFlag': true
                    },
                    {
                        'field': 'OWNER',
                        'type': 'text',
                        'disabled': false,
                        'fillFlag': true
                    },
                    {
                        'field': 'UPDATE_DATE',
                        'type': 'text',
                        'disabled': true,
                        'fillFlag': true
                    },
                    {
                        'field': 'EXECUTIVE',
                        'type': 'text',
                        'disabled': true,
                        'fillFlag': true
                    },
                    {
                        'field': 'CREATE_TIME',
                        'type': 'text',
                        'disabled': true,
                        'fillFlag': true
                    },
                    {
                        'field': 'EDIT_TIME',
                        'type': 'text',
                        'disabled': true,
                        'fillFlag': true
                    },
                    {
                        'field': 'EDIT_EMP',
                        'type': 'text',
                        'disabled': true,
                        'fillFlag': true
                    },
                    {
                        'field': 'STATUS',
                        'type': 'select',
                        'disabled': false,
                        'fillFlag': true
                    },
                    {
                        'field': 'ITEM_SOURCE',
                        'type': 'text',
                        'disabled': true,
                        'fillFlag': true
                    },
                    {
                        'field': 'JUSTIFICATION',
                        'type': 'text',
                        'disabled': false,
                        'fillFlag': true
                    }
                ],
                "sendList": ['DEV_NUMBER', 'DEV_TYPE', 'CUSTOMER_DEV', 'BU', 'MFG', 'DATE_ORIGINATED', 'EFFECTIVE_FROM', 'EFFECTIVE_TO', 'ITEM_NUMBER', 'OWNER', 'UPDATE_DATE', 'EXECUTIVE', 'CREATE_TIME', 'EDIT_TIME', 'EDIT_EMP', 'STATUS', 'ITEM_SOURCE', 'JUSTIFICATION']
            },
        },
        "loadLayerData": {                                              //弹出框的控件的所有操作（大框内特殊控件数据加载[加载完页面数据后自动执行]）
            'Edit': function (loadSelect, generatTable) {
                loadSelect($("select[name=STATUS]"), ['LOCK', 'UNLOCK']);
                this.find("input[name=JUSTIFICATION]").blur(function (e) {
                    if (this.value.length < 20) {
                        layer.msg("输入的值长度需要大于20位，请重新输入！", {
                            icon: 0,
                            time: 2000
                        });
                    }
                });
            }
        },
        "btnClick": {                                                       //点击按钮及后续所有操作（所有弹出框都要配置，大框动态变化，处理特殊控件（如表格），处理数据[用于发送至后台]，返回数据）
            "Edit": {
                "retSendData": function (sendData) {                                    //点击按钮执行（二次处理数据，sendData：第一次处理的发送数据 this：弹出框）
                    if (sendData.JUSTIFICATION.length >= 20) {
                        return sendData;
                    } else {
                        layer.msg("输入的值长度需要大于20位！", {
                            icon: 0,
                            time: 2000
                        });
                    }                                                         //返回的数据为最终发送的数据 重要！！！
                },
                "callBackPass": function (e, msgTip, $table, $layerBtn) {          //接收的数据pass后的操作（this：弹出框 e：接收的数据 msgTip：提示函数，不包含刷新页面，$table：表格节点，$layerBtn：弹出框的按钮集合）
                    msgTip();                                                                      //提示信息
                    $layerBtn[0].click();
                    location.reload();                                                             //刷新整个页面
                },
                "callBackFail": function (e, msgTip, $table, $layerBtn) {             //请求失败后的操作，参数上同
                    msgTip();
                }
            },
            "Link": {
                "retSendData": function (sendData) {
                    return sendData;
                },
                "callBackPass": function (e, msgTip, $table, $layerBtn) {
                    msgTip();
                },
                "callBackFail": function (e, msgTip, $table, $layerBtn) {
                    msgTip();
                }
            },
        }
    }

    if (self.parent.client.UserInfo.EMP_LEVEL == '9' || self.parent.client.UserInfo.Department == 'DCC' || self.parent.client.UserInfo.Department == 'PM' ) {
        c.pageMsg.btnMsg.push({
              "id": "btn1",
              "btnName": "Edit",
              "layerBtnName": "edit",
              "icon": "glyphicon glyphicon-pencil",
              "style": "1",
              "layerFlag": true
        })
    }

    var report = new ConfigReport(c);

    function GetNow() { //add by zc
        var myDate = new Date();
        //获取当前年
        var year = myDate.getFullYear();
        //获取当前月
        var month = myDate.getMonth() + 1;
        //获取当前日
        var date = myDate.getDate();
        var h = myDate.getHours();       //获取当前小时数(0-23)
        var m = myDate.getMinutes();     //获取当前分钟数(0-59)
        var s = myDate.getSeconds();
        var times = {};
        times.now = year + "/" + month + "/" + date + " " + h + ':' + m + ":" + s;
        return times;
    }

</script>
</html>
